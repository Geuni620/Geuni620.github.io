{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/2023/8/30/mobile-notch/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<blockquote>\n<p>PWA로 모바일용 애플리케이션을 만들고 있다.<br>\n점심을 먹다가, 동료 직원분께 “기록이 서비스 이렇게 사용해보고 있어요.”라고 공유드렸는데, “아이폰 아랫부분 Footer가 왜 겹치죠?”라는 질문에 찾아보기 시작했다.<br>\n이게 모바일 기준 UI를 잡을 때 노치(notch)라는 걸 알게됐고, 노치대응을 해야한다는 것도 알게 됐다.<br>\n하지만 문제는, notch 대응을 했음에도 불구하고, 로그인 후 dashboard → record 페이지로 이동하면, 아래 Footer의 노치대응이 풀려버리고, 다시 dashboard로 돌아오니 노치대응이 되지 않았다.</p>\n</blockquote>\n<h3 id=\"meta-tag\" style=\"position:relative;\"><a href=\"#meta-tag\" aria-label=\"meta tag permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Meta tag</h3>\n<p>노치대응을 위해서 meta tag를 하나 심어줘야하는데, 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">// layout.tsx\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span>\n    <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport-fit=cover<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>위와 같은 meta tag를 심어줘야 css notch 속성이 온전히 동작하는 듯 하다.</li>\n<li>나의 경우엔 다음과 같이 적용했다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">// layout.tsx\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span>\n    <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>근데, 이상하다. 배포 후 head tag를 찾아보는데, viewport 속성이 <code class=\"language-text\">중복</code>되게 들어가있었다.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5ee2cb710e68464bc0f0d86ed77679d7/6f641/notch-img.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.6875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABaUlEQVQY02XI2XKaYABAYd7/VTpt0xo3UDFN46RCJODSaONGcYnIL2sUBE8nzUxvevHNnDnSRmmzLDdZXl8x/qoyur5lWW/iVK+YlmSMDyrW5zbmJ5WFcoutdli0OtitO5yb76xvvrEWKU4Eq/CCFDQbvJQquOWPLL7U+V2us6pWWJQq2HWVraLwIss4tSYbpcW63mBbq7KuNfDaKkFbJtx5+H6CLyKktCUT6CaHjor4obG9N3HuTFYdk502IDJNAk3D7Vp4ukVoDQge+4TWkHgwIh7+JNB6hPo76dS9xzf6CO2BXddE9Pp4moEw+my7j7g9i72us9EH7I0h+fOYfDahmI3Jp2Py5yfO08nf90bKkoxwtiGYT5g9uUzGAmd5YGfbbKdzrJHPr1mEdzgi3APnKKRIjhSvR8jSd+f0X0vxLkLMBVkSE7+ecaMLIrngxW9dsA8L/KTglOZksccpDjlFGWmScYH//AEudbCZ7GLkkgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5ee2cb710e68464bc0f0d86ed77679d7/a59e9/notch-img.webp 192w,\n/static/5ee2cb710e68464bc0f0d86ed77679d7/0ca9f/notch-img.webp 384w,\n/static/5ee2cb710e68464bc0f0d86ed77679d7/dc9b9/notch-img.webp 768w,\n/static/5ee2cb710e68464bc0f0d86ed77679d7/230f6/notch-img.webp 1116w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5ee2cb710e68464bc0f0d86ed77679d7/3b721/notch-img.png 192w,\n/static/5ee2cb710e68464bc0f0d86ed77679d7/66595/notch-img.png 384w,\n/static/5ee2cb710e68464bc0f0d86ed77679d7/fe486/notch-img.png 768w,\n/static/5ee2cb710e68464bc0f0d86ed77679d7/6f641/notch-img.png 1116w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5ee2cb710e68464bc0f0d86ed77679d7/fe486/notch-img.png\"\n            alt=\"viewport가 2개 들어가 있다.\"\n            title=\"viewport가 2개 들어가 있다.\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">viewport가 2개 들어가 있다.</figcaption>\n  </figure></p>\n<p>viewport 속성을 중복되는 부분을 제거한 상태로 배포를 해보았다.<br>\n그러자, name이 viewport 2개 들어가 있으면, <strong>가장 마지막에 읽힌 viewport만 적용되는 것 같았다.</strong></p>\n<br>\n<p>이상했다. 그럼 next.js app directory에선 viewport가 자동으로 심어지는건가? 자동으로 심어지는 건 제거하고, 내가 head tag내에 심은 viewport가 적용되길 바랐다.\nnext.js github issue 탭을 확인하고, 공식문서에서 meta-tag 적용방법을 확인해보다가 알게됐다.</p>\n<p>next.js내에서는 <a href=\"https://nextjs.org/docs/app/api-reference/functions/generate-metadata#viewport\" target=\"_blank\" rel=\"nofollow\">meta tag 중 viewport</a>를 링크에서 처럼 적용하도록 되어있었고,\ndefault로 설정되어 있는 상태에서 layout 내에서 head태그를 넣고, 적용하니 <strong>중복</strong>이 발생하는 것이었다.</p>\n<p>결국 아래와 같이 수정해주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">//layout</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> metadata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  viewport<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    width<span class=\"token operator\">:</span> <span class=\"token string\">'device-width'</span><span class=\"token punctuation\">,</span>\n    initialScale<span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span>\n    minimumScale<span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span>\n    maximumScale<span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span>\n    userScalable<span class=\"token operator\">:</span> <span class=\"token string\">'no'</span><span class=\"token punctuation\">,</span>\n    viewportFit<span class=\"token operator\">:</span> <span class=\"token string\">'cover'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  manifest<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    href<span class=\"token operator\">:</span> <span class=\"token string\">'/manifest.json'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  icons<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    apple<span class=\"token operator\">:</span> <span class=\"token string\">'/icon-192x192.png'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  themeColor<span class=\"token operator\">:</span> <span class=\"token string\">'#84A59D'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>위와 같이 수정 후, 배포를 하니 <strong>viewport는 1개만 적용</strong>되어있고, 배포 후 페이지를 자유롭게 이동해도 노치 대응한게 풀리지 않는다!</li>\n</ul>","tableOfContents":"<ul>\n<li><a href=\"#meta-tag\">Meta tag</a></li>\n</ul>","frontmatter":{"title":"모바일 노치(notch) 대응 후, 페이지 이동 시 notch 대응 풀리는 현상","summary":"app directory로 notch 대응했으나, 페이지 이동시 풀리는 현상","date":"2023.08.30.","categories":["개발"]}}}]}},"pageContext":{"slug":"/blog/2023/8/30/mobile-notch/"}},"staticQueryHashes":["1629908903"]}