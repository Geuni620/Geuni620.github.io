{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/2023/8/3/next-build-type/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<blockquote>\n<p>next.js의 build type은 SSG / SSR / ISG가 있고, react는 CSR이다.\n그럼 build 했을 때 api로 데이터 fetching을 할텐데, 이건 항상 최신 데이터일까?</p>\n</blockquote>\n<br>\n<p><a href=\"https://github.com/Geuni620/csr-ssr-ssg-isg-fetching.git\" target=\"_blank\" rel=\"nofollow\">build type에 따른 데이터 fetcing 실험은 이 github repo에서 확인할 수 있다.</a></p>\n<p>이 실험에선, server를 express를 통해서 간단히 구현했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// server</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/api/time\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">YYYY</span> <span class=\"token operator\">=</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">getFullYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">MM</span> <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getMonth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">DD</span> <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">HH</span> <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getHours</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> mm <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getMinutes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> ss <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getSeconds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">YYYY</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">MM</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">DD</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">HH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>mm<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ss<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"server\"</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// client</span>\n<span class=\"token comment\">// SSR / SSG</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getTime</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://127.0.0.1:8000/api/time</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">cache</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">//cache는 SSR과 SSG일 때 각각 다르게 적용해야한다.</span>\n    <span class=\"token comment\">// SSR - no-cache</span>\n    <span class=\"token comment\">// SSG - force-cache</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ISG</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getTime</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://127.0.0.1:8000/api/time</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">next</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">revalidate</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">// ISG의 경우 revalidate Time을 10s로 적용했다. (ms가 아니다!)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"m-2\"</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Server Side Render </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>data<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// CSR, next.js가 아닌 react + vite를 사용했다</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>time<span class=\"token punctuation\">,</span> setTime<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>loading<span class=\"token punctuation\">,</span> setLoading<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://127.0.0.1:8000/api/time\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setTime</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">setLoading</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"An error occurred while fetching data:\"</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">setLoading</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"card\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>Current time from server<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>time<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> App<span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<p>api로 요청을 보내면 현재 시간을 반환한다. 정확한 비교를 위해 ms까지 반환한다.\n모든 build type은 <code class=\"language-text\">npm run build</code> 이후, <code class=\"language-text\">npm start</code>하여 테스트했다.\n결과는 다음과 같다.</p>\n<p>CSR - 항상 최신데이터를 반환한다.\nSSR - 항상 최신데이터를 반환한다.</p>\n<br>\n<p>SSG는 build 될 때, 데이터 fetching을 하고, 이때 api통해 반환된 시간에서 <strong>10분 후에 새로고침을 해도 시간이 변경되지 않았다.</strong></p>\n<br>\n<p>ISG는 build 될 때 데이터를 fetching하고, revalidate time을 적용하면, 그 time마다 re-generate하게 되는데, 이떄 데이터 fetching을 다시한다.\n조금 특이한 점이 있는데 이는 실험한 순서대로 적어보겠다.</p>\n<ol>\n<li>\n<p>npm start 후 찍힌 시간()\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/380f8b3c9083fcaf27c7b19be61ee4ea/740ad/isg-log-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA0UlEQVQY032R207DMBBE8/+/B+oDEKlQAjEtbW52NvHlVJvEwAOtpZXG1u7RzLpwzmGt3cqR79M0kY/qz7petPiZQRwhBPrJ0Y4DMUVIiZQSBXeONmRgvQEbGYgk2qbFjYIAndi1n0SRNvKtykBTmwVkLifK5xeeypKP3Q4eHrnYjqAuYQVmN1n/51CBOnTszhzNF69vB8x+Tzy8c7bdGluBfwfvRjZmjTz2jPOE9545BBovv5F1hzFGbkHzm4hQVdWi9TPU0ffQLNW6Xpf3A7wCfoLVYs8OejIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/380f8b3c9083fcaf27c7b19be61ee4ea/a59e9/isg-log-1.webp 192w,\n/static/380f8b3c9083fcaf27c7b19be61ee4ea/0ca9f/isg-log-1.webp 384w,\n/static/380f8b3c9083fcaf27c7b19be61ee4ea/dc9b9/isg-log-1.webp 768w,\n/static/380f8b3c9083fcaf27c7b19be61ee4ea/e2c2f/isg-log-1.webp 1152w,\n/static/380f8b3c9083fcaf27c7b19be61ee4ea/f3efb/isg-log-1.webp 1536w,\n/static/380f8b3c9083fcaf27c7b19be61ee4ea/4a7a2/isg-log-1.webp 1984w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/380f8b3c9083fcaf27c7b19be61ee4ea/3b721/isg-log-1.png 192w,\n/static/380f8b3c9083fcaf27c7b19be61ee4ea/66595/isg-log-1.png 384w,\n/static/380f8b3c9083fcaf27c7b19be61ee4ea/fe486/isg-log-1.png 768w,\n/static/380f8b3c9083fcaf27c7b19be61ee4ea/d2d74/isg-log-1.png 1152w,\n/static/380f8b3c9083fcaf27c7b19be61ee4ea/e8464/isg-log-1.png 1536w,\n/static/380f8b3c9083fcaf27c7b19be61ee4ea/740ad/isg-log-1.png 1984w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/380f8b3c9083fcaf27c7b19be61ee4ea/fe486/isg-log-1.png\"\n            alt=\"Build 후 찍힌 시간 00:59:51 / 실제시간 00:59:53\"\n            title=\"Build 후 찍힌 시간 00:59:51 / 실제시간 00:59:53\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Build 후 찍힌 시간 00:59:51 / 실제시간 00:59:53</figcaption>\n  </figure></p>\n</li>\n<li>\n<p>10초 후 새로고침(2023-08-05 00:59:51)\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2d721210ddefbdf2c9c132941fc53154/740ad/isg-log-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAsUlEQVQY031R0Q7CIAzc//+W7z4aH9w0Kg7dyzQBKWU7U0LJYnRNLj0aelxL472Hc67AQ89EBA3hvbWZT9MEZgYnxosciCPmea5osBJyQQVtEWROOY/jiODepca1p1mq/8K3oLhvuw6n9ojteY/NY4cYi0sVVDfK1xzKSoZhwO1q0NoLDs++CmaHy8bVke/3zKVZRpScIgMx1ZHzDmXJ/0S1FkKAMaZ+ijwgNQFFwnLKD1061pTIfBWoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2d721210ddefbdf2c9c132941fc53154/a59e9/isg-log-2.webp 192w,\n/static/2d721210ddefbdf2c9c132941fc53154/0ca9f/isg-log-2.webp 384w,\n/static/2d721210ddefbdf2c9c132941fc53154/dc9b9/isg-log-2.webp 768w,\n/static/2d721210ddefbdf2c9c132941fc53154/e2c2f/isg-log-2.webp 1152w,\n/static/2d721210ddefbdf2c9c132941fc53154/f3efb/isg-log-2.webp 1536w,\n/static/2d721210ddefbdf2c9c132941fc53154/4a7a2/isg-log-2.webp 1984w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2d721210ddefbdf2c9c132941fc53154/3b721/isg-log-2.png 192w,\n/static/2d721210ddefbdf2c9c132941fc53154/66595/isg-log-2.png 384w,\n/static/2d721210ddefbdf2c9c132941fc53154/fe486/isg-log-2.png 768w,\n/static/2d721210ddefbdf2c9c132941fc53154/d2d74/isg-log-2.png 1152w,\n/static/2d721210ddefbdf2c9c132941fc53154/e8464/isg-log-2.png 1536w,\n/static/2d721210ddefbdf2c9c132941fc53154/740ad/isg-log-2.png 1984w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2d721210ddefbdf2c9c132941fc53154/fe486/isg-log-2.png\"\n            alt=\"Build 후 찍힌 시간 00:59:51 / 실제시간 01:00:02\"\n            title=\"Build 후 찍힌 시간 00:59:51 / 실제시간 01:00:02\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Build 후 찍힌 시간 00:59:51 / 실제시간 01:00:02</figcaption>\n  </figure></p>\n</li>\n<li>\n<p>새로고침 후 Build 시간이 변경된 시간\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e0219fa58d9afd43a3adc0b7e4f158cd/740ad/isg-log-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAu0lEQVQY031RXQvCMAzs//9xPvq2KrjiPkQ6Wb/XnKSuY4gucDSkd9ckFdZaGGMKOK+IMaJGCAH3rit5zhkpJaQlYQ4W2s/IlAEiEBEEDoIJ1bBbDdmMQ2sNZ2zhTN58+CAIWp3/4dvQOQcpJS6NxPnW4PSUeJgJS87lXlTR3uCoQ+89hnFE27ZQQ4frqy/rqVyxFx6O3PclZzGPzWcMERSXbQ1lh3lt9ZdprXFXSqntU/gBrjFCDNhP+QZJY9aPavXqWgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e0219fa58d9afd43a3adc0b7e4f158cd/a59e9/isg-log-3.webp 192w,\n/static/e0219fa58d9afd43a3adc0b7e4f158cd/0ca9f/isg-log-3.webp 384w,\n/static/e0219fa58d9afd43a3adc0b7e4f158cd/dc9b9/isg-log-3.webp 768w,\n/static/e0219fa58d9afd43a3adc0b7e4f158cd/e2c2f/isg-log-3.webp 1152w,\n/static/e0219fa58d9afd43a3adc0b7e4f158cd/f3efb/isg-log-3.webp 1536w,\n/static/e0219fa58d9afd43a3adc0b7e4f158cd/4a7a2/isg-log-3.webp 1984w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e0219fa58d9afd43a3adc0b7e4f158cd/3b721/isg-log-3.png 192w,\n/static/e0219fa58d9afd43a3adc0b7e4f158cd/66595/isg-log-3.png 384w,\n/static/e0219fa58d9afd43a3adc0b7e4f158cd/fe486/isg-log-3.png 768w,\n/static/e0219fa58d9afd43a3adc0b7e4f158cd/d2d74/isg-log-3.png 1152w,\n/static/e0219fa58d9afd43a3adc0b7e4f158cd/e8464/isg-log-3.png 1536w,\n/static/e0219fa58d9afd43a3adc0b7e4f158cd/740ad/isg-log-3.png 1984w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e0219fa58d9afd43a3adc0b7e4f158cd/fe486/isg-log-3.png\"\n            alt=\"Build 후 찍힌 시간 01:00:11 / 실제시간 01:00:13\"\n            title=\"Build 후 찍힌 시간 01:00:11 / 실제시간 01:00:13\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Build 후 찍힌 시간 01:00:11 / 실제시간 01:00:13</figcaption>\n  </figure></p>\n</li>\n<li>\n<p>server log\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cc873239a779e1e8e43595250fbb2635/be2a9/isg-server-log.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABWklEQVQoz3WR23LaMBRF+ZaGAOlDAGPiu+VrbcvXGGNsmLT//xWrg0Myk5Q+rDlnJO0lndFMsUyK0qeufUTo4IYOO8tioeifLHc6qxs/9zpP6jvXvcet9uXszBA2l1PEn3OMzD2STNA0AVnuESWCX6nAj11S6aG5NiJyWRsmG8Pkx1r7lH6IZ7prc+5D3oaIvPDoDyHHQ0Bd+Zy6kLYJ8CMHzbG4Xn6te9tCcy3Wusn8+wtVz6W5ZHS/JX4RkLQRsk/wpE/WxaRtTD3miDwkLgOqMZvWfOnzrBn/jqyKiOw44MgKISuybqAcLgRVS9x0eEWDPI6oXsTDVmP1YrLcm8wVnYfNnZEVJyR97XHTkmZ8o+zPyMNA1p6mGlcHljuD+fqFxS04hbfa/U/Zi6vwiJ0U5N04SdL2RFC8Tr0n60n4PXhP9i60bTamzUIxeFJNVjeuko/+f+F7/AUlcBAudTKmygAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/cc873239a779e1e8e43595250fbb2635/a59e9/isg-server-log.webp 192w,\n/static/cc873239a779e1e8e43595250fbb2635/0ca9f/isg-server-log.webp 384w,\n/static/cc873239a779e1e8e43595250fbb2635/27bf3/isg-server-log.webp 748w\"\n              sizes=\"(max-width: 748px) 100vw, 748px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/cc873239a779e1e8e43595250fbb2635/3b721/isg-server-log.png 192w,\n/static/cc873239a779e1e8e43595250fbb2635/66595/isg-server-log.png 384w,\n/static/cc873239a779e1e8e43595250fbb2635/be2a9/isg-server-log.png 748w\"\n            sizes=\"(max-width: 748px) 100vw, 748px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/cc873239a779e1e8e43595250fbb2635/be2a9/isg-server-log.png\"\n            alt=\"isg server log\"\n            title=\"isg server log\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</li>\n</ol>\n<br>\n<p>즉 ISG는 다음과 같이 동작한다.</p>\n<ol>\n<li>\n<p>build 되었을 때 시간 00:59:51</p>\n</li>\n<li>\n<p>10초 후 새로고침을 하면 기존에 build 되었을 때 시간을 반환한다 00:59:51</p>\n<ul>\n<li>이때 re-generate 되기 시작</li>\n</ul>\n</li>\n<li>\n<p>새로고침을 계속해도 00:59:51을 반환한다</p>\n<ul>\n<li>그러다가 시간이 변경되는데, (01:00:11) 이건 re-generate가 된 후 build 된 시간이다.</li>\n<li>즉 re-generate가 끝나는시간은 항상 10초를 보장하지 않는다.</li>\n<li>re-generate가 1초만에 끝났을 수도 있고, 10초가 넘어가서 끝났을 수도 있다.</li>\n<li>즉, re-generate가 끝난 후 요청이 들어오면 re-generate 된 파일을 전달한다.</li>\n</ul>\n</li>\n</ol>\n<br>\n<h3 id=\"참고자료\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"참고자료 permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고자료</h3>\n<p><a href=\"https://velog.io/@dldngus5/nextjs-revalidate\" target=\"_blank\" rel=\"nofollow\">[Next.js] Incremental Static Regeneration의 revalidate (re-generation)테스트</a></p>","tableOfContents":"<ul>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\">참고자료</a></li>\n</ul>","frontmatter":{"title":"CSR / SSR / SSG / ISG는 항상 최신데이터를 가져올까?","summary":"-","date":"2023.08.03.","categories":["개발"]}}}]}},"pageContext":{"slug":"/blog/2023/8/3/next-build-type/"}},"staticQueryHashes":["1629908903"]}