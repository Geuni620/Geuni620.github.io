{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/2023/10/3/next-js-suspense-usequery/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p><a href=\"https://github.com/Geuni620/suspense-fallback-ui\" target=\"_blank\" rel=\"nofollow\">ì‹¤í—˜ ë ˆí¬</a></p>\n<blockquote>\n<p>í˜„ì¬ ì§„í–‰ ì¤‘ì¸ í”„ë¡œì íŠ¸ì—ì„œ Nav Barì— userì˜ ì •ë³´ë¥¼ ì„œë²„ë¡œ ìš”ì²­í•œ í›„ ë°˜í™˜ë°›ì•„ ë³´ì—¬ì¤˜ì•¼í•˜ëŠ” ê²Œ ìˆë‹¤.<br>\nì´ë•Œ Nav Bar ë‚´ì—ì„œ useQueryë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë°, ìƒˆë¡œê³ ì¹¨ì„ í•˜ë©´ Suspenseë¥¼ ì ìš©í•´ì„œ fallback uië¥¼ ë³´ì—¬ì£¼ê³ ì í–ˆë‹¤.<br>\ní•˜ì§€ë§Œ fallback uiê°€ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë˜ì„œ í…ŒìŠ¤íŠ¸í•´ë³´ê¸° ì‹œì‘í–ˆë‹¤.</p>\n</blockquote>\n<br>\n<h3 id=\"êµ¬ì„±ìš”ì†Œ\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%EC%84%B1%EC%9A%94%EC%86%8C\" aria-label=\"êµ¬ì„±ìš”ì†Œ permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>êµ¬ì„±ìš”ì†Œ</h3>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// app/page.tsx</span>\n<span class=\"token string\">'use client'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> UsequeryComp <span class=\"token keyword\">from</span> <span class=\"token string\">'app/components/UsequeryComp'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Suspense <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">useQuery loading...</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flex items-center justify-center bg-blue-500<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UsequeryComp</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>ë¨¼ì € root pageì— client-componentsë¡œ ë³€ê²½ì‹œì¼œì£¼ê³ , <code class=\"language-text\">UsequeryComp</code>ë¥¼ Suspenseë¡œ ê°ì‹¸ì¤¬ë‹¤.</li>\n<li>ì—¬ê¸°ì„œ <code class=\"language-text\">UsequeryComp</code>ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í–ˆë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// app/components/UsequeryComp.tsx</span>\n<span class=\"token string\">'use client'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@tanstack/react-query'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> axiosPostQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'app/api/route'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Post <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@/type'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">UsequeryComp</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data<span class=\"token operator\">:</span> posts <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'posts'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axiosPostQuery<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>posts<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>post<span class=\"token operator\">:</span> Post<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> UsequeryComp<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>ê·¸ë¦¬ê³  <code class=\"language-text\">axiosPostQuery</code>ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í–ˆë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// app/api/route.ts</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">wait</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>ms<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token builtin\">Promise</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> ms<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">axiosPostQuery</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">wait</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ëª…í™•íˆ fallback uië¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ waitë¥¼ ê±¸ì–´ì¤¬ë‹¤.</span>\n\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'https://jsonplaceholder.typicode.com/posts'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>axiosPostQueryë¥¼ ì‚¬ìš©í•œ ì´ìœ ëŠ”, next.js 13 versionì˜ fetchëŠ” Web APIì¸ <strong>fetchì™€ ì¡°ê¸ˆ ë‹¤ë¥´ê¸° ë•Œë¬¸ì´ë‹¤.</strong></li>\n<li>next.js appë””ë ‰í† ë¦¬ì— ë§ê²Œ cache ë“±ì´ í¬í•¨ëœ í™•ì¥ëœ <a href=\"https://nextjs.org/docs/app/api-reference/functions/fetch\" target=\"_blank\" rel=\"nofollow\">fetch API</a> ì´ë‹¤.</li>\n<li>ê·¸ë˜ì„œ ìˆœìˆ˜í•˜ê²Œ cache ì„¤ì •ì„ ë”°ë¡œ í•˜ì§€ ì•Šì€ axiosë¥¼ ì„¤ì¹˜í•´ì„œ ì‚¬ìš©í–ˆë‹¤.</li>\n</ul>\n<br>\n<h3 id=\"ì›í•˜ëŠ”-ë™ì‘\" style=\"position:relative;\"><a href=\"#%EC%9B%90%ED%95%98%EB%8A%94-%EB%8F%99%EC%9E%91\" aria-label=\"ì›í•˜ëŠ” ë™ì‘ permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì›í•˜ëŠ” ë™ì‘</h3>\n<ul>\n<li>ì›í•˜ëŠ” ë™ì‘ì€ ì‹¬í”Œí•˜ë‹¤.</li>\n</ul>\n<blockquote>\n<p>ìƒˆë¡œê³ ì¹¨ì„ í•  ë•Œë§ˆë‹¤ fallback uiê°€ ë³´ì—¬ì•¼í•œë‹¤.</p>\n</blockquote>\n<ul>\n<li>ì›ì¸ì„ íŒŒì•…í•  ìˆ˜ ì—†ì–´, <code class=\"language-text\">react</code>ë¡œ ë™ì¼í•˜ê²Œ êµ¬ì„±í–ˆì—ˆë‹¤.<br>\n<code class=\"language-text\">* reactëŠ” ìœ„ ì‹¤í—˜ë ˆí¬ì—ì„œ branchë¡œ ë¶„ë¦¬ì‹œì¼œë†“ì•˜ë‹¤.</code></li>\n<li>reactëŠ” ìƒˆë¡œê³ ì¹¨í•  ë•Œë§ˆë‹¤ suspesneì˜ fallback uiê°€ ë„ì›Œì§„ë‹¤.</li>\n<li>í•˜ì§€ë§Œ next.jsë¥¼ ìƒˆë¡œê³ ì¹¨í•  ë•Œë§ˆë‹¤ suspesne fallback uië¥¼ ë„ìš°ë‹¤ê°€ ì–´ëŠìˆœê°„ì—” <strong>ì¦‰ì‹œ ë°ì´í„°ë¥¼ ë°˜í™˜í•´ë²„ë¦°ë‹¤.</strong></li>\n</ul>\n<br>\n<h3 id=\"ì›ì¸íŒŒì•…-ì¤‘\" style=\"position:relative;\"><a href=\"#%EC%9B%90%EC%9D%B8%ED%8C%8C%EC%95%85-%EC%A4%91\" aria-label=\"ì›ì¸íŒŒì•… ì¤‘ permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì›ì¸íŒŒì•… ì¤‘</h3>\n<ul>\n<li>í˜„ì¬ ì›ì¸ì„ ê³„ì† íŒŒì•…í•˜ëŠ” ì¤‘ì´ë‹¤.</li>\n<li>cache ë˜ì—ˆëŠ”ê²Œ ë¶„ëª…í•˜ê¸´ í•œë°, ì–´ë””ì„œ ì–´ë–»ê²Œ cache ëœ ê²ƒì¸ì§€ ëª¨ë¥´ê² ë‹¤.</li>\n<li>network tabì—ì„œ <code class=\"language-text\">disable cache</code>ì˜µì…˜ì„ ì²´í¬í–ˆëŠ”ë°ë„ ë¶ˆêµ¬í•˜ê³  ìƒˆë¡œê³ ì¹¨ì„ ì—°ë°œí•˜ë‹¤ë³´ë©´, ì¦‰ì‹œ ë°ì´í„°ë¥¼ ë°˜í™˜í•œë‹¤.</li>\n<li>ì˜ì•„í•´ì„œ Nav Barë¥¼ ë§Œë“¤ê³  í˜ì´ì§€ ë¼ìš°íŒ…ì„ ì‹œì¼œë³´ì•˜ëŠ”ë°, í˜ì´ì§€ ë¼ìš°íŒ…ì„ ì‹œí‚¤ë©´ Suspenseì˜ fallback UIê°€ ëŒê¸°ì‹œì‘í•œë‹¤.</li>\n</ul>\n<br>\n<h3 id=\"network-tab-í™•ì¸í•˜ê¸°\" style=\"position:relative;\"><a href=\"#network-tab-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\" aria-label=\"network tab í™•ì¸í•˜ê¸° permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Network tab í™•ì¸í•˜ê¸°</h3>\n<p>network tabì˜ <code class=\"language-text\">throttling</code>ë„ ê±¸ì–´ë³´ê³ , <code class=\"language-text\">disable cache</code>ë„ ì ìš©í•´ë³´ì•˜ëŠ”ë°,<br>\nì´ë²ˆì—” <strong>localhostë¡œ ê°€ì ¸ì˜¤ëŠ” HTMLë¥¼ í™•ì¸</strong>í•´ë³´ê¸°ë¡œ í–ˆë‹¤.</p>\n<p>ì™œëƒí•˜ë©´, ì„œë²„ì»´í¬ë„ŒíŠ¸ëŠ”, ì„œë²„ì—ì„œ HTMLë¥¼ ê·¸ë ¤ì„œ ê°€ì ¸ì˜¬í…Œë‹ˆê¹Œ, ë°ì´í„° fetchingì´ ëë‚˜ì§€ ì•Šì•˜ë‹¤ë©´, Suspenseê°€ ì»´í¬ë„ŒíŠ¸ë¥¼ ê·¸ë¦¬ë‹¤ê°€ ì¤‘ë‹¨í•˜ê³  ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë¶€í„° ê·¸ë¦¬ê²Œ ë˜ê³ ,<br>\nì»´í¬ë„ŒíŠ¸ê°€ ë‹¤ ê·¸ë ¤ì§€ë©´ ë‹¤ì‹œ Suspenseë¡œ ëŒì•„ì™€ì„œ í•´ë‹¹ ë°ì´í„°ê°€ resolve ë˜ì—ˆëŠ”ì§€ í™•ì¸í•œë‹¤.<br>\nresolve ë˜ì§€ ì•Šì•˜ë‹¤ë©´ fallback uië¥¼ ë³´ì—¬ì¤„ ê²ƒì´ë‹¤.<br>\n<a href=\"https://geuni620.github.io/blog/2023/9/8/useQuery%20vs%20userQuery+Suspense/#%EC%97%AC%EA%B8%B0%EC%84%9C-%EC%9E%A0%EA%B9%90%EB%A7%8C\" target=\"_blank\" rel=\"nofollow\">ìœ„ ë‚´ìš©ì€ ì´ì „ ë¸”ë¡œê·¸ ê¸€ì—ì„œ ì‘ì„±í•œ ë‚´ìš©ì´ë‹¤.</a></p>\n<br>\n<p>ê·¸ëŸ¼ fallback uiì¸ loadingì´ë¼ê³  ì°í˜€ìˆì–´ì•¼í•˜ì§€ ì•Šì„ê¹Œ?</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a24422567de1b880833ac8d9b1a011eb/98c82/client-query-fallback.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.166666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAyklEQVQY043PvU7DMBSGYd8wQ2fExsZNIJjpyoXAWKrWTYWqJNhpLfkntl9kl0YwpOKT3vXROeJ+uWfxJLl5lCyeG+6WitsXzcOrRp9GtI7oU8S4SIzpeikh9jtJ336iugODaiF7YKwpZXh7P9A0LcdBUZZzno2cEVvZoIcjKWV8GHHO16x1xFjgSErlukgmn1HmJ6Tc0fVfKKXx3v8UcM5V5PfOR+SridXHmq7vKxBCmCrwBZxemuD5G8VmKzHGVKCgl6y1f8D/7htCMtClD86ppQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a24422567de1b880833ac8d9b1a011eb/a59e9/client-query-fallback.webp 192w,\n/static/a24422567de1b880833ac8d9b1a011eb/0ca9f/client-query-fallback.webp 384w,\n/static/a24422567de1b880833ac8d9b1a011eb/dc9b9/client-query-fallback.webp 768w,\n/static/a24422567de1b880833ac8d9b1a011eb/e2c2f/client-query-fallback.webp 1152w,\n/static/a24422567de1b880833ac8d9b1a011eb/592a3/client-query-fallback.webp 1456w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a24422567de1b880833ac8d9b1a011eb/3b721/client-query-fallback.png 192w,\n/static/a24422567de1b880833ac8d9b1a011eb/66595/client-query-fallback.png 384w,\n/static/a24422567de1b880833ac8d9b1a011eb/fe486/client-query-fallback.png 768w,\n/static/a24422567de1b880833ac8d9b1a011eb/d2d74/client-query-fallback.png 1152w,\n/static/a24422567de1b880833ac8d9b1a011eb/98c82/client-query-fallback.png 1456w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a24422567de1b880833ac8d9b1a011eb/fe486/client-query-fallback.png\"\n            alt=\"ì²« loading ì‹œ\"\n            title=\"ì²« loading ì‹œ\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">ì²« loading ì‹œ</figcaption>\n  </figure></p>\n<ul>\n<li>ìœ„ ì´ë¯¸ì§€ ì²˜ëŸ¼ fallback uiê°€ ì˜ ë³´ì—¬ì§€ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<br>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/13afe0ef7b974387514e4ceee69a7ef1/98c82/client-query-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.166666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABKklEQVQY012Qy07CQBSG+/5v4IIXkMSNLoiX6EIXLBRRpMVguAhSWnuZtkxbOtPPdBAVJ/ly5mQyX/5zLHs05n3xwXK1xvV8so1kI3M2UiLzijjWpBLyCmp+z9+76esapTSW7y4QwRoRuGTiE6i+2SKlYjbLWa1ChIiIoog4jg1CiAOyLDNi6+Ruztl9wI1TcjWUnD+ndJ5Srl8SKqURIqDff8S2bfNpL0iS5KBKKXfC9u2S1sWco86M1uWCdjfmuJtw+iAotgrf9xkObUajEZPJxPT7hEEQmNRhGFKW5U74Nn7Fc5eI0CeNA1AF1FtqVaC1xvM8BoOBSdjU/diNsHn/v0crigUyL34WrXRtqCqF1jWu69Lr9XAcxwin06kZL8/zH2EjamgSfgFxNcVotINTpwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/13afe0ef7b974387514e4ceee69a7ef1/a59e9/client-query-data.webp 192w,\n/static/13afe0ef7b974387514e4ceee69a7ef1/0ca9f/client-query-data.webp 384w,\n/static/13afe0ef7b974387514e4ceee69a7ef1/dc9b9/client-query-data.webp 768w,\n/static/13afe0ef7b974387514e4ceee69a7ef1/e2c2f/client-query-data.webp 1152w,\n/static/13afe0ef7b974387514e4ceee69a7ef1/592a3/client-query-data.webp 1456w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/13afe0ef7b974387514e4ceee69a7ef1/3b721/client-query-data.png 192w,\n/static/13afe0ef7b974387514e4ceee69a7ef1/66595/client-query-data.png 384w,\n/static/13afe0ef7b974387514e4ceee69a7ef1/fe486/client-query-data.png 768w,\n/static/13afe0ef7b974387514e4ceee69a7ef1/d2d74/client-query-data.png 1152w,\n/static/13afe0ef7b974387514e4ceee69a7ef1/98c82/client-query-data.png 1456w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/13afe0ef7b974387514e4ceee69a7ef1/fe486/client-query-data.png\"\n            alt=\"ìƒˆë¡œê³ ì¹¨ í–ˆì„ ë•Œ\"\n            title=\"ìƒˆë¡œê³ ì¹¨ í–ˆì„ ë•Œ\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">ìƒˆë¡œê³ ì¹¨ í–ˆì„ ë•Œ</figcaption>\n  </figure></p>\n<ul>\n<li>ìƒˆë¡œê³ ì¹¨ì„ í•˜ë©´ ë°ì´í„°ê°€ cachingë˜ì–´ fallback uië¥¼ ë³´ì—¬ì£¼ì§€ ì•ŠëŠ”ë‹¤.</li>\n</ul>\n<br>\n<h3 id=\"ì„œë²„-ì»´í¬ë„ŒíŠ¸ëŠ”\" style=\"position:relative;\"><a href=\"#%EC%84%9C%EB%B2%84-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EB%8A%94\" aria-label=\"ì„œë²„ ì»´í¬ë„ŒíŠ¸ëŠ” permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì„œë²„ ì»´í¬ë„ŒíŠ¸ëŠ”?</h3>\n<ul>\n<li>ìœ„ì˜ í…ŒìŠ¤íŠ¸ëŠ” í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ í…ŒìŠ¤íŠ¸í•´ë³¸ ê²ƒì´ë‹¤.</li>\n<li>ê·¸ëŸ¼ ì„œë²„ì»´í¬ë„ŒíŠ¸ë„ ë™ì¼í•˜ê²Œ suspenseë¡œ ê°ì‹¸ì¤¬ì„ ë•Œ fallback uië¥¼ ì˜ ë„ì›Œì¤„ê¹Œ?</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// app/server</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Suspense <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> UseServerComp <span class=\"token keyword\">from</span> <span class=\"token string\">'../components/server/UseServerComp'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">...server loading</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flex items-center justify-center bg-yellow-400<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UseServerComp</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// app/components/server/UseServerComp.tsx</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Post <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@/type'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> serverPostQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../api/route'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> UseServerComp<span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">FC</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> posts <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">serverPostQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span>posts<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>post<span class=\"token operator\">:</span> Post<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> UseServerComp<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>ìœ„ì™€ ê°™ì´ server componentsë¥¼ êµ¬ì„±í•´ì¤¬ë‹¤.</li>\n<li>ë˜‘ê°™ì´ network tabì—ì„œ ì´ë¯¸ì§€</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bce5ade2b33c668b03815cdb9a1f2a39/ed887/server-comp-fallback.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAwElEQVQY03WOy26DMBQF+f/f66oRJeSBA9jGxgZTnlPFClEX4UqjszpzT/L1nXETJaXUL1TkUUtkY2idxTiLkJpKNUilUY1BGxuplcY6TxcGfB9ITnlJmp1Js5xTmiEeFV3XY1tHGAaqeib9CdyLXzaOb9s21nUlkUVBfrlibUvrHCEE5nlmmqaIMR1FoZDSxtIRz1uWhUSKjNtd4L1nHMcoeebOpyVHwriwFILz5UpVS/q+fy/bhZ+Ke/5/sgv/AJPkgpSAe3hkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bce5ade2b33c668b03815cdb9a1f2a39/a59e9/server-comp-fallback.webp 192w,\n/static/bce5ade2b33c668b03815cdb9a1f2a39/0ca9f/server-comp-fallback.webp 384w,\n/static/bce5ade2b33c668b03815cdb9a1f2a39/dc9b9/server-comp-fallback.webp 768w,\n/static/bce5ade2b33c668b03815cdb9a1f2a39/e2c2f/server-comp-fallback.webp 1152w,\n/static/bce5ade2b33c668b03815cdb9a1f2a39/0e833/server-comp-fallback.webp 1484w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bce5ade2b33c668b03815cdb9a1f2a39/3b721/server-comp-fallback.png 192w,\n/static/bce5ade2b33c668b03815cdb9a1f2a39/66595/server-comp-fallback.png 384w,\n/static/bce5ade2b33c668b03815cdb9a1f2a39/fe486/server-comp-fallback.png 768w,\n/static/bce5ade2b33c668b03815cdb9a1f2a39/d2d74/server-comp-fallback.png 1152w,\n/static/bce5ade2b33c668b03815cdb9a1f2a39/ed887/server-comp-fallback.png 1484w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bce5ade2b33c668b03815cdb9a1f2a39/fe486/server-comp-fallback.png\"\n            alt=\"server components\"\n            title=\"server components\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">server components</figcaption>\n  </figure></p>\n<ul>\n<li>ë™ì¼í•˜ê²Œ ì²« ë¡œë”©ì‹œ Suspenseê°€ ì˜ ëŒê¸° ì‹œì‘í•œë‹¤.</li>\n<li>í•˜ì§€ë§Œ, ìœ„ì˜ useQuery + Suspenseë¥¼ ê°ì‹¸ì¤¬ì„ ë•Œì™€ëŠ” ë‹¤ë¥´ê²Œ ìƒˆë¡œê³ ì¹¨í•  ë•Œë§ˆë‹¤ fallback uiê°€ ì˜ ë³´ì¸ë‹¤.</li>\n</ul>\n<br>\n<h3 id=\"ê²°ë¡ \" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"ê²°ë¡  permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê²°ë¡ </h3>\n<ul>\n<li>ê²°êµ­ <strong>next.js app directoryëŠ” client components / server components ëª¨ë‘ suspenseë¥¼ ì§€ì›í•œë‹¤.</strong></li>\n<li>í•˜ì§€ë§Œ client components ì¤‘ useQuery + SuspenseëŠ” cache Timeì„ 0ìœ¼ë¡œ ì„¤ì •í•´ì¤¬ì–´ë„, cache ë˜ì–´ì„œ ìƒˆë¡œê³ ì¹¨í–ˆì„ ë•Œ ë°”ë¡œ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤.</li>\n<li>ì´ëŸ´ ê²½ìš°ì— ìƒˆë¡œê³ ì¹¨í•  ë•Œë§ˆë‹¤ loading fallbackì„ ë³´ì—¬ì£¼ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í•´ì£¼ë©´ ëœë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token string\">'use client'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// import UsequeryComp from 'app/components/UsequeryComp';</span>\n<span class=\"token keyword\">import</span> dynamic <span class=\"token keyword\">from</span> <span class=\"token string\">'next/dynamic'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Suspense <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> UsequeryComp <span class=\"token operator\">=</span> <span class=\"token function\">dynamic</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./components/UsequeryComp'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  ssr<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">loading</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">useQuery loading...</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flex items-center justify-center bg-blue-500<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UsequeryComp</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>ìœ„ì™€ ê°™ì´ êµ¬ì„±í•´ì£¼ë©´ dynamic import ë‚´ Suspenseê°€ í¬í•¨ë˜ì–´ìˆì–´ loading fallbackì„ ìƒˆë¡œê³ ì¹¨í•  ë•Œë§ˆë‹¤ ë³´ì—¬ì¤„ ìˆ˜ ìˆì—ˆë‹¤.</li>\n<li>í•˜ì§€ë§Œ useQuery + Suspenseë¥¼ ì‚¬ìš©í•˜ë©´ ìƒˆë¡œê³ ì¹¨ ì—°ë°œí•˜ë‹¤ê°€ ì–´ëŠìˆœê°„ cache ëœ ë°ì´í„°ë¥¼ ì¦‰ì‹œ ë°˜í™˜í•œë‹¤.\n<ul>\n<li><code class=\"language-text\">ì´ê²Œ ì›ì¸ì´ ë¬´ì—‡ì¸ì§€ ëª¨ë¥´ê² ë‹¤. ã… ã… , cache ëœ ê±° ê°™ì€ë°, queryê°€? nextê°€? ì–´ë–»ê²Œ cache ëœ ê±´ì§€ ì›ì¸ì„ ëª¨ë¥´ê² ë‹¤.</code></li>\n</ul>\n</li>\n</ul>\n<br>\n<h3 id=\"ë²ˆì™¸\" style=\"position:relative;\"><a href=\"#%EB%B2%88%EC%99%B8\" aria-label=\"ë²ˆì™¸ permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë²ˆì™¸</h3>\n<blockquote>\n<p>ë§¨ ì²˜ìŒ â€˜ì´ë•Œ Nav Bar ë‚´ì—ì„œ useQueryë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë°, ìƒˆë¡œê³ ì¹¨ì„ í•˜ë©´ Suspenseë¥¼ ì ìš©í•´ì„œ fallback uië¥¼ ë³´ì—¬ì£¼ê³ ì í–ˆë‹¤.â€˜ì— ëŒ€í•œ ì›ì¸ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>\n</blockquote>\n<ul>\n<li>next-authë¥¼ í†µí•´ useSession hooksìœ¼ë¡œ userì˜ emailì„ ê°€ì ¸ì™€ì„œ api ìš”ì²­ì‹œ paramsì— ë„£ì–´ í•¨ê»˜ ìš”ì²­ì„ ë³´ë‚¸ë‹¤.</li>\n<li>ì´ë•Œ ë‹¤ìŒê³¼ ê°™ì´ useQueryë¥¼ ì„¤ì •í–ˆë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">useUserInfoGetQuery</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>userEmail<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> userInfo <span class=\"token operator\">=</span> <span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>userManagerKeys<span class=\"token punctuation\">.</span>userInfo<span class=\"token punctuation\">,</span> userEmail<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">getUserInfo</span><span class=\"token punctuation\">(</span>userEmail<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      enabled<span class=\"token operator\">:</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>userEmail<span class=\"token punctuation\">,</span> <span class=\"token comment\">// enabled</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> userInfo<span class=\"token operator\">:</span> userInfo<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">,</span> isLoading<span class=\"token operator\">:</span> userInfo<span class=\"token punctuation\">.</span>isLoading <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>ì£¼ì„ìœ¼ë¡œ í‘œì‹œí•´ë‘ì—ˆë“¯ì´, useEmailì´ ì¡´ì¬í•  ë•Œë§Œ useQueryê°€ apië¥¼ ìš”ì²­í•œë‹¤.</li>\n<li>ì¦‰, userEmail ë˜í•œ sessionì— userEmailì„ ê°€ì ¸ì™€ì„œ ìš”ì²­ì„ ë³´ë‚´ì•¼í•œë‹¤.</li>\n<li>Suspenseë¡œ ê°ì‹¸ì¤¬ë‹¤ í•œ ë“¤, userEmailì´ ì—†ë‹¤ë©´ Suspenseê°€ ëŒì§€ ì•ŠëŠ”ë‹¤.</li>\n<li>ì•„ë§ˆ ì´ê²ƒ ë•Œë¬¸ì´ì—ˆë˜ ê²ƒ ê°™ë‹¤. userEmailì´ ì—†ëŠ” ìƒíƒœë¼ì„œ useQueryê°€ ëŒì§€ ì•Šì•˜ë‹¤.</li>\n<li>ê·¸ë˜ì„œ Nav ìš”ì²­ì„ ë³´ë‚¼ ë•Œ userEmailì„ mockingìœ¼ë¡œ ë„£ì–´ì£¼ê³  í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆë‹¤.</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 764px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/aff0aa024d21374a8e2146d6768663c9/2cbcd/remove-enabled.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.4375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA9ElEQVQY04WNy0rDQBiF89L6BPoMdmmlLhQRFdSKK3VTEC8oIoqaTKYT27S5I5nmMp8kVqhQ8IPD+RfnnN9K0hTlfbby5u77k9anQUie5yg1RLoCTw2ZBgFBGBInCWEUEcUxRTFrpbXGiuME2xHYjottC4SQjMY+H7ZDkn1xutejs77KwdYGnbUVzve327Jy3gn8EXmu6R9uctHv0WAJV/Ly+oYrFY6QaD1jkcebASe7XS7Pjjje6XI3uCJNUzwpmPhjsizj4f6a56fbn8GyLCmKksarqsIY80fLaLK1MVRV3XZ+aW5rWWFxzNT1v0/qeaYZ/AYe8XdvoGZyrQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/aff0aa024d21374a8e2146d6768663c9/a59e9/remove-enabled.webp 192w,\n/static/aff0aa024d21374a8e2146d6768663c9/0ca9f/remove-enabled.webp 384w,\n/static/aff0aa024d21374a8e2146d6768663c9/83502/remove-enabled.webp 764w\"\n              sizes=\"(max-width: 764px) 100vw, 764px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/aff0aa024d21374a8e2146d6768663c9/3b721/remove-enabled.png 192w,\n/static/aff0aa024d21374a8e2146d6768663c9/66595/remove-enabled.png 384w,\n/static/aff0aa024d21374a8e2146d6768663c9/2cbcd/remove-enabled.png 764w\"\n            sizes=\"(max-width: 764px) 100vw, 764px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/aff0aa024d21374a8e2146d6768663c9/2cbcd/remove-enabled.png\"\n            alt=\"ì ì‹¬ì‹œê°„ì´ ëë‚˜ê°€ì„œ ê¸‰í•˜ê²Œ fallbackì„ ì ì—ˆë‹¤...ğŸ¥²\"\n            title=\"ì ì‹¬ì‹œê°„ì´ ëë‚˜ê°€ì„œ ê¸‰í•˜ê²Œ fallbackì„ ì ì—ˆë‹¤...ğŸ¥²\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">ì ì‹¬ì‹œê°„ì´ ëë‚˜ê°€ì„œ ê¸‰í•˜ê²Œ fallbackì„ ì ì—ˆë‹¤...ğŸ¥²</figcaption>\n  </figure></p>\n<p>í™•ì¸ê²°ê³¼ enabled ë•Œë¬¸ì— useQueryê°€ ëŒì§€ ì•Šì•˜ë˜ ê²Œ ë§ì•˜ë‹¤.</p>\n<br>","tableOfContents":"<ul>\n<li><a href=\"#%EA%B5%AC%EC%84%B1%EC%9A%94%EC%86%8C\">êµ¬ì„±ìš”ì†Œ</a></li>\n<li><a href=\"#%EC%9B%90%ED%95%98%EB%8A%94-%EB%8F%99%EC%9E%91\">ì›í•˜ëŠ” ë™ì‘</a></li>\n<li><a href=\"#%EC%9B%90%EC%9D%B8%ED%8C%8C%EC%95%85-%EC%A4%91\">ì›ì¸íŒŒì•… ì¤‘</a></li>\n<li><a href=\"#network-tab-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\">Network tab í™•ì¸í•˜ê¸°</a></li>\n<li><a href=\"#%EC%84%9C%EB%B2%84-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EB%8A%94\">ì„œë²„ ì»´í¬ë„ŒíŠ¸ëŠ”?</a></li>\n<li><a href=\"#%EA%B2%B0%EB%A1%A0\">ê²°ë¡ </a></li>\n<li><a href=\"#%EB%B2%88%EC%99%B8\">ë²ˆì™¸</a></li>\n</ul>","frontmatter":{"title":"next.jsì—ì„œ useQuery + Suspenseë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ fallback uiê°€ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤ -1","summary":"reactì—ì„  ìƒˆë¡œê³ ì¹¨í•  ë•Œë§ˆë‹¤ fallback uië¥¼ ì˜ ë³´ì—¬ì£¼ëŠ”ë°...","date":"2023.10.03.","categories":["ê°œë°œ"]}}}]}},"pageContext":{"slug":"/blog/2023/10/3/next-js-suspense-usequery/"}},"staticQueryHashes":["1629908903"]}