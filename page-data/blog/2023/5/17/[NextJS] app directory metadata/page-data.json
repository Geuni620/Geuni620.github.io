{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/2023/5/17/[NextJS] app directory metadata/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<blockquote>\n<p>해당 내용은 사내 블로그를 app디렉토리로 개발하며 metadata를 적용했던 사례를 소개해보려 한다.</p>\n</blockquote>\n<br>\n<h3 id=\"og-tag--twitter-card\" style=\"position:relative;\"><a href=\"#og-tag--twitter-card\" aria-label=\"og tag  twitter card permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OG tag / Twitter Card</h3>\n<ul>\n<li>OG Tag와 Twitter Card가 meta data내에선 표준처럼 쓰이는 듯하다.</li>\n<li>즉, OG Tag는 메타(전 페이스북), Twitter card는 말 그대로 twiiter이다.</li>\n<li>현재 OG Tag와 Twitter Card를 적용한 상태에서 다음과 같은 서비스에 링크를 붙여넣었을 때 모두 잘 적용되었다.\n<ul>\n<li>잔디, 카카오톡, 슬랙, 페이스북, 트위터, 노션</li>\n</ul>\n</li>\n</ul>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// app/layout.tsx</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> metadata<span class=\"token operator\">:</span> Metadata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  metadataBase<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token constant\">URL</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://deep.jejodo.life'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  generator<span class=\"token operator\">:</span> <span class=\"token string\">'Next.js 13.3.0'</span><span class=\"token punctuation\">,</span>\n  title<span class=\"token operator\">:</span> <span class=\"token string\">'제대로 된 조직문화 도큐먼트'</span><span class=\"token punctuation\">,</span>\n  description<span class=\"token operator\">:</span> <span class=\"token string\">'제조도의 조직문화를 소개합니다.'</span><span class=\"token punctuation\">,</span>\n  icons<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    icon<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      url<span class=\"token operator\">:</span> <span class=\"token string\">'/favicon.png'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// 해당 부분은 Favicon을 적용할 때 사용된다.</span>\n      type<span class=\"token operator\">:</span> <span class=\"token string\">'image/png'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  openGraph<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    title<span class=\"token operator\">:</span> <span class=\"token string\">'제대로 된 조직문화 도큐먼트'</span><span class=\"token punctuation\">,</span>\n    description<span class=\"token operator\">:</span> <span class=\"token string\">'제조도의 조직문화를 소개합니다.'</span><span class=\"token punctuation\">,</span>\n    url<span class=\"token operator\">:</span> <span class=\"token string\">'https://deep.jejodo.life'</span><span class=\"token punctuation\">,</span>\n    siteName<span class=\"token operator\">:</span> <span class=\"token string\">'제대로 된 조직문화 도큐먼트'</span><span class=\"token punctuation\">,</span>\n    locale<span class=\"token operator\">:</span> <span class=\"token string\">'ko-KR'</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token operator\">:</span> <span class=\"token string\">'website'</span><span class=\"token punctuation\">,</span>\n    images<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        url<span class=\"token operator\">:</span> <span class=\"token string\">'https://deep.jejodo.life/ogImage.png'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 절대경로를 사용해야하지만 metadataBase를 적용했다면 상대경로로도 가능하다.</span>\n        width<span class=\"token operator\">:</span> <span class=\"token number\">1200</span><span class=\"token punctuation\">,</span>\n        height<span class=\"token operator\">:</span> <span class=\"token number\">630</span><span class=\"token punctuation\">,</span>\n        type<span class=\"token operator\">:</span> <span class=\"token string\">'image/png'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  twitter<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    card<span class=\"token operator\">:</span> <span class=\"token string\">'summary'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// summary와 summary_large_image가 존재한다. summary는 작은 이미지, summary_large_image는 큰 이미지를 사용한다.</span>\n    title<span class=\"token operator\">:</span> <span class=\"token string\">'제대로 된 조직문화 도큐먼트'</span><span class=\"token punctuation\">,</span>\n    description<span class=\"token operator\">:</span> <span class=\"token string\">'제조도의 조직문화를 소개합니다.'</span><span class=\"token punctuation\">,</span>\n    images<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'https://deep.jejodo.life/ogImage.png'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 해당부분은 포스트를 링크로 공유할 경우 적용된다.</span>\n<span class=\"token comment\">// app/[slug]/[pageId]/page.tsx</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">generateMetadata</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> params <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> Props<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>Metadata<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>pageId<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> posts <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getPosts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> post <span class=\"token operator\">=</span> <span class=\"token function\">findPostById</span><span class=\"token punctuation\">(</span>posts<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> title <span class=\"token operator\">=</span> post<span class=\"token operator\">?.</span>title<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> previousImages <span class=\"token operator\">=</span> post<span class=\"token operator\">?.</span>thumbnail <span class=\"token operator\">||</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> author <span class=\"token operator\">=</span> post<span class=\"token operator\">?.</span>author<span class=\"token operator\">?.</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">?.</span>name <span class=\"token operator\">||</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> createdTime <span class=\"token operator\">=</span> post<span class=\"token operator\">?.</span>createdTime <span class=\"token operator\">||</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> category <span class=\"token operator\">=</span> post<span class=\"token operator\">?.</span>category<span class=\"token operator\">?.</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    title<span class=\"token operator\">:</span> title<span class=\"token punctuation\">,</span>\n    description<span class=\"token operator\">:</span> title<span class=\"token punctuation\">,</span>\n    openGraph<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      images<span class=\"token operator\">:</span> previousImages<span class=\"token punctuation\">,</span>\n      type<span class=\"token operator\">:</span> <span class=\"token string\">'article'</span><span class=\"token punctuation\">,</span>\n      authors<span class=\"token operator\">:</span> author<span class=\"token punctuation\">,</span>\n      publishedTime<span class=\"token operator\">:</span> createdTime<span class=\"token punctuation\">,</span>\n      description<span class=\"token operator\">:</span> <span class=\"token string\">'제조도의 조직문화를 소개합니다.'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    twitter<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      card<span class=\"token operator\">:</span> <span class=\"token string\">'summary'</span><span class=\"token punctuation\">,</span>\n      title<span class=\"token operator\">:</span> title<span class=\"token punctuation\">,</span>\n      description<span class=\"token operator\">:</span> <span class=\"token string\">'제조도의 조직문화를 소개합니다.'</span><span class=\"token punctuation\">,</span>\n      images<span class=\"token operator\">:</span> previousImages<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    alternates<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      canonical<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://deep.jejodo.life/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>category<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>참고로 nextJS 13.2버전부턴 Head 태그가 사라졌다. 불러올 순 있으나, 적용되진 않는다.</li>\n<li>그래서 layout이나, page내에서 metadata를 정의해준다.\n<ul>\n<li>정의하는 방법은 위와 같이 간단하다.(작성하면서 간단하다고 생각했지, 전혀 간단하진 않았다.)</li>\n</ul>\n</li>\n</ul>\n<br>\n<p>위의 경우엔 root페이지(”/“)의 title과 블로그 포스트의 타이틀을 동일하게 구성했다. 하지만 이렇게도 사용이 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// app/layout.tsx</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> metadata<span class=\"token operator\">:</span> Metadata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  generator<span class=\"token operator\">:</span> <span class=\"token string\">'Next.js 13.3.0'</span><span class=\"token punctuation\">,</span>\n  title<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> <span class=\"token string\">'제대로 된 조직문화 도큐먼트'</span><span class=\"token punctuation\">,</span>\n    template<span class=\"token operator\">:</span> <span class=\"token string\">'%s | 제조도'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// app/[slug]/[pageId]/page.tsx</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> metadata<span class=\"token operator\">:</span> Metadata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  title <span class=\"token operator\">:</span> <span class=\"token string\">\"여기는 posts 페이지\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>위와 같이 작성하면 main 페이지에선 크롬 탭의 title에 “제대로 된 조직문화 도큐먼트”가 출력된다.</li>\n<li>포스트로 들어갔을 때엔 “여기는 posts 페이지 | 제대로 된 조직문화 도큐먼트”가 출력된다.</li>\n<li>절대값을 지정해서 해당 포스트 페이지에선 title만 띄우는 것도 가능하다.</li>\n<li>모든 것은 <a href=\"https://nextjs.org/docs/app/api-reference/functions/generate-metadata#metadata-fields\" target=\"_blank\" rel=\"nofollow\">공식문서</a> 내에 잘 기록되어있다.</li>\n</ul>\n<br>\n<ul>\n<li>그리고 가장 중요한 점,\n<ul>\n<li>나는 OG Image, Twitter Card를 적용하면서 엄청 고생했다. 왜냐하면 변경을 했음에도 불구하고 적용이 되지 않았기 때문이다.</li>\n<li>하지만 적용은 잘 되어있다. Caching 된 데이터를 그대로 불러오기 때문에 적용되지 않은 것처럼 보일 뿐이다.</li>\n<li>그래서 대부분은 ‘캐시 비우기’를 해주면 잘 적용되어 있을 것이다.</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://deep.jejodo.life\nhttps://deep.jejodo.life/</code></pre></div>\n<ul>\n<li>위 아래 og image가 달라서 엄청 고민했다.</li>\n<li>결국 캐싱된 데이터를 그대로 불러와서 favicon 이미지를 계속 불러왔던 것 뿐, 캐시를 싹 비우고 다시 불러오니 원하는대로 잘 불러와졌다.</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/82382e1391ba402314ce76d08b5e7d4a/f101e/remove-cache.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.29166666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABAUlEQVQY041QW46DMBDj/lfpZfqzLSUklEQ8QkIeQKsCEl5luqvdz45kWbITa8bZcRxISCOlwjAYPJ5P+BhR1RJf1xw3VuKS31CKCry6g3EBca9R3WvSxA+rpkUWYsQ0TZiXBc45hBAQ44Skj87D+0A8jsmL8CHAeU/+NM9/b0dHXiaVQtv16LXGuq6w1kAphaZpMMWITycFvl4vZL/Ctm3Y94027LoOfd9jWZaPwtJ1Wg+UkZ3PZ5xOJzKSyLnA5XJFUTDk+Q2MMXDOURQF+VTB6KieNzyMtdS91hpZEtu2xb7vGIYBUkoKrWsJIQTKsiRmrKTNjXl//g9jDKy1FPgNpUrEoIMAj0UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/82382e1391ba402314ce76d08b5e7d4a/a59e9/remove-cache.webp 192w,\n/static/82382e1391ba402314ce76d08b5e7d4a/0ca9f/remove-cache.webp 384w,\n/static/82382e1391ba402314ce76d08b5e7d4a/dc9b9/remove-cache.webp 768w,\n/static/82382e1391ba402314ce76d08b5e7d4a/333e7/remove-cache.webp 870w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/82382e1391ba402314ce76d08b5e7d4a/3b721/remove-cache.png 192w,\n/static/82382e1391ba402314ce76d08b5e7d4a/66595/remove-cache.png 384w,\n/static/82382e1391ba402314ce76d08b5e7d4a/fe486/remove-cache.png 768w,\n/static/82382e1391ba402314ce76d08b5e7d4a/f101e/remove-cache.png 870w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/82382e1391ba402314ce76d08b5e7d4a/fe486/remove-cache.png\"\n            alt=\"크롬 개발자 도구를 열어놓은 상태에서 새로고침을 꾹 누르면 드롭다운 바가 뜬다. 맨 아래를 클릭하면 된다.\"\n            title=\"크롬 개발자 도구를 열어놓은 상태에서 새로고침을 꾹 누르면 드롭다운 바가 뜬다. 맨 아래를 클릭하면 된다.\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">크롬 개발자 도구를 열어놓은 상태에서 새로고침을 꾹 누르면 드롭다운 바가 뜬다. 맨 아래를 클릭하면 된다.</figcaption>\n  </figure></p>\n<br>\n<h3 id=\"canonical-url\" style=\"position:relative;\"><a href=\"#canonical-url\" aria-label=\"canonical url permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Canonical URL</h3>\n<ul>\n<li>Canonical URL에 대한 자세한 설명은 <a href=\"https://developers.google.com/search/docs/crawling-indexing/consolidate-duplicate-urls?hl=ko&#x26;visit_id=638199289246195899-2459427862&#x26;rd=1\" target=\"_blank\" rel=\"nofollow\">중복 페이지 URL 표준화 및 표준 태그 사용</a>를 참고하자.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">return</span><span class=\"token punctuation\">(</span>\n<span class=\"token comment\">// layout.tsx</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>notoSansKR<span class=\"token punctuation\">.</span>className<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>canonical<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://deep.jejodo.life<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        ...\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>이 부분은 metadata로 적용하는 설명이 안나와있어, root segment의 layout.tsx의 html 태그 내에 넣어주었다.\n<ul>\n<li>deploy 후 확인해보니 link 태그가 잘 적용되어 있었다.</li>\n</ul>\n</li>\n</ul>\n<br>\n<h3 id=\"google-analytics\" style=\"position:relative;\"><a href=\"#google-analytics\" aria-label=\"google analytics permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Google analytics</h3>\n<ul>\n<li>Google analytics(이하 GA)는 어디에, 어떻게 붙여줘야할까?</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// components/Analytics.tsx</span>\n<span class=\"token string\">'use client'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// client components</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GA_TRACKING_ID</span> <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">GOOGLE_ANALYTICS_ID</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> useGtagEffect <span class=\"token keyword\">from</span> <span class=\"token string\">'hook/useGtagEffect'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Script <span class=\"token keyword\">from</span> <span class=\"token string\">'next/script'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Analytics</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">useGtagEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Script</span></span>\n        <span class=\"token attr-name\">strategy</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>afterInteractive<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">src</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://www.googletagmanager.com/gtag/js?id=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">GA_TRACKING_ID</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Script</span></span>\n        <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>gtag<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">strategy</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>afterInteractive<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">dangerouslySetInnerHTML</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n          __html<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', '</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">GA_TRACKING_ID</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">', {\n              page_path: window.location.pathname,\n            });\n          </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Analytics<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// useGtagEffect.ts</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> gtag <span class=\"token keyword\">from</span> <span class=\"token string\">'lib/gtag'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> usePathname<span class=\"token punctuation\">,</span> useSearchParams <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next/navigation'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">useGtagEffect</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> pathname <span class=\"token operator\">=</span> <span class=\"token function\">usePathname</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> searchParams <span class=\"token operator\">=</span> <span class=\"token function\">useSearchParams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pathname<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      gtag<span class=\"token punctuation\">.</span><span class=\"token function\">pageview</span><span class=\"token punctuation\">(</span>pathname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>pathname<span class=\"token punctuation\">,</span> searchParams<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> useGtagEffect<span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">// app/layout.tsx</span>\n<span class=\"token keyword\">import</span> Analytics <span class=\"token keyword\">from</span> <span class=\"token string\">'components/Analytics'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">RootLayout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> RootLayoutProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>notoSansKR<span class=\"token punctuation\">.</span>className<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>canonical<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://deep.jejodo.life<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Analytics</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        //...\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>기존에 설명이 잘 되어있는 부분이라 크게 다른 것은 없다.</li>\n<li>굳이 다른 점 하나를 뽑자면, useRouter를 사용하던 이전 버전에 비해 <a href=\"https://nextjs.org/docs/app/api-reference/functions/use-pathname\" target=\"_blank\" rel=\"nofollow\">usePathname</a>이라는 hook을 사용하여 편하게 적용할 수 있다.</li>\n<li>참고로 이 <a href=\"https://dev.to/valse/how-to-setup-google-tag-manager-in-a-next-13-app-router-website-248p\" target=\"_blank\" rel=\"nofollow\">블로그</a>가 유용했다.</li>\n</ul>\n<br>\n<h3 id=\"웹-마스터-등록하기\" style=\"position:relative;\"><a href=\"#%EC%9B%B9-%EB%A7%88%EC%8A%A4%ED%84%B0-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B8%B0\" aria-label=\"웹 마스터 등록하기 permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>웹 마스터 등록하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> metadata<span class=\"token operator\">:</span> Metadata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  verification<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    google<span class=\"token operator\">:</span> <span class=\"token string\">'something'</span><span class=\"token punctuation\">,</span>\n    other<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string-property property\">'naver-site-verification'</span><span class=\"token operator\">:</span> <span class=\"token string\">'something'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>대표적으로 네이버와 구글을 등록해줬다. 즉, 구글에서 우리 웹사이트를, 네이버에서 우리 웹사이트를 검색했을 때 검색결과로 나오도록 추가해주었다.</li>\n<li>구글은 이런 점에서 조금 불친절하다. 등록하고 나서 적용되는데 기간이 조금 걸리는 듯하다.</li>\n<li>해당 부분은 공식문서 <a href=\"https://nextjs.org/docs/app/api-reference/functions/generate-metadata#verification\" target=\"_blank\" rel=\"nofollow\">verification</a>에 나와있다</li>\n<li>naver는 따로 구성된게 없어서 other에 직접 추가해주었다.</li>\n</ul>\n<br>\n<h3 id=\"ga를-이용해서-페이지별-조회수-추가해주기\" style=\"position:relative;\"><a href=\"#ga%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%B4%EC%84%9C-%ED%8E%98%EC%9D%B4%EC%A7%80%EB%B3%84-%EC%A1%B0%ED%9A%8C%EC%88%98-%EC%B6%94%EA%B0%80%ED%95%B4%EC%A3%BC%EA%B8%B0\" aria-label=\"ga를 이용해서 페이지별 조회수 추가해주기 permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GA를 이용해서 페이지별 조회수 추가해주기</h3>\n<blockquote>\n<p>조금 달라진 api 폴더를 사용했다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// api/google/views/route.ts</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> BetaAnalyticsDataClient <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@google-analytics/data'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> NextResponse <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next/server'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> analyticsDataClient <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BetaAnalyticsDataClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  credentials<span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">ANALYTICS_CREDENTIALS</span> <span class=\"token operator\">||</span> <span class=\"token string\">'{}'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token constant\">GET</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 달라진 api 폴더내에선 함수명이 HTTP method명으로 바뀌었따.</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>response<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> analyticsDataClient<span class=\"token punctuation\">.</span><span class=\"token function\">runReport</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    property<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">properties/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">ANALYTICS_PROPERTY_ID</span> <span class=\"token operator\">||</span> <span class=\"token string\">''</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    dateRanges<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        startDate<span class=\"token operator\">:</span> <span class=\"token string\">'2023-05-01'</span><span class=\"token punctuation\">,</span>\n        endDate<span class=\"token operator\">:</span> <span class=\"token string\">'today'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    dimensions<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">'pagePath'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    metrics<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">'screenPageViews'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    dimensionFilter<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      filter<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        fieldName<span class=\"token operator\">:</span> <span class=\"token string\">'pagePath'</span><span class=\"token punctuation\">,</span>\n        stringFilter<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          matchType<span class=\"token operator\">:</span> <span class=\"token string\">'BEGINS_WITH'</span><span class=\"token punctuation\">,</span>\n          value<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/do-comments/</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>rows<span class=\"token operator\">?.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>row<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// path와 조회수를 반환해준다.</span>\n      path<span class=\"token operator\">:</span> row<span class=\"token punctuation\">.</span>dimensionValues<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span>\n      views<span class=\"token operator\">:</span> row<span class=\"token punctuation\">.</span>metricValues<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">NextResponse</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> status<span class=\"token operator\">:</span> <span class=\"token number\">200</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>해당 코드는 이 <a href=\"https://blog.yeppyshiba.com/article/adding-view-count-in-gatsby/\" target=\"_blank\" rel=\"nofollow\">블로그</a>를 참고했다.\n<ul>\n<li>gatsby로 되어있지만, plugin 차이일 뿐 api 호출은 크게 다르지 않았다. (사실 거의 똑같았다.)</li>\n</ul>\n</li>\n<li>구글에선 다양한 방법으로 API를 제공해준다. 그래서 오히려 더 헷갈렸다.</li>\n<li>단순 Node만을 이용해서 lib로 데이터를 가져올 수 있는 위 방법을 조금 더 일찍 발견했다면 큰 고민없이 바로 적용했을 것 같다.</li>\n</ul>\n<br>\n<ul>\n<li>한 가지 조금 우려되는 점은, 조회수 산정 기준이 무엇인지 잘 모르겠다. 하루 전 날에 tracking 한 후 다음 날 반영되는 듯 하다.</li>\n<li>실시간으로 적용하려면 realTime method를 사용해야하는 것 같다.</li>\n</ul>\n<br>\n<h3 id=\"참고자료\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"참고자료 permalink\" class=\"headerElement before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고자료</h3>\n<p>이 외에 참고자료가 많다. 모두 도움이 많이 되었다. 🙇‍♂️</p>\n<br>\n<p><a href=\"https://velog.io/@henrynoowah/Next.js-v13.2-Feature-Metadata\" target=\"_blank\" rel=\"nofollow\">[Next.js] - v13.2 Feature: Metadata</a></p>\n<p><a href=\"https://akoskm.com/how-to-make-nextjs-13-more-seo-friendly\" target=\"_blank\" rel=\"nofollow\">How to Make Next.js 13 More SEO-Friendly</a></p>\n<p><a href=\"https://youtu.be/CIb0OthD_sM\" target=\"_blank\" rel=\"nofollow\">Next.js 13 new Metadata API with SEO support | Next.js 13.2 Tutorial</a></p>\n<p><a href=\"https://developer.twitter.com/en/docs/twitter-for-websites/cards/overview/markup\" target=\"_blank\" rel=\"nofollow\">Twiiter Card tag</a></p>\n<p><a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/metadata/app-icons\" target=\"_blank\" rel=\"nofollow\">favicon.ico, apple-icon.jpg, and icon.jpg</a></p>","tableOfContents":"<ul>\n<li><a href=\"#og-tag--twitter-card\">OG tag / Twitter Card</a></li>\n<li><a href=\"#canonical-url\">Canonical URL</a></li>\n<li><a href=\"#google-analytics\">Google analytics</a></li>\n<li><a href=\"#%EC%9B%B9-%EB%A7%88%EC%8A%A4%ED%84%B0-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B8%B0\">웹 마스터 등록하기</a></li>\n<li><a href=\"#ga%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%B4%EC%84%9C-%ED%8E%98%EC%9D%B4%EC%A7%80%EB%B3%84-%EC%A1%B0%ED%9A%8C%EC%88%98-%EC%B6%94%EA%B0%80%ED%95%B4%EC%A3%BC%EA%B8%B0\">GA를 이용해서 페이지별 조회수 추가해주기</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\">참고자료</a></li>\n</ul>","frontmatter":{"title":"[NextJS] app 디렉토리 metadata","summary":"-","date":"2023.05.17.","categories":["개발"]}}}]}},"pageContext":{"slug":"/blog/2023/5/17/[NextJS] app directory metadata/"}},"staticQueryHashes":["1629908903"]}